# TagStock 테스트 체크리스트

Phase 2 MVP를 위한 종합 테스트 체크리스트입니다.

## 사전 테스트 설정

- [ ] `.env.local`의 모든 환경 변수 구성 완료
- [ ] 데이터베이스 마이그레이션 성공적으로 실행됨
- [ ] 스토리지 버킷 생성 및 구성 완료
- [ ] OAuth 제공자 구성 완료
- [ ] Stripe 테스트 모드 활성화됨
- [ ] Gemini API 키 유효함
- [ ] 개발 서버 실행 중 (`npm run dev`)

## 인증 및 권한

### OAuth 로그인
- [ ] Google OAuth 로그인 작동 확인
- [ ] Apple OAuth 로그인 작동 확인 (구성된 경우)
- [ ] X (Twitter) OAuth 로그인 작동 확인 (구성된 경우)
- [ ] 로그인 후 대시보드로 리다이렉트됨
- [ ] 데이터베이스에 프로필이 자동으로 생성됨
- [ ] 무료 사용자의 초기 크레딧이 10으로 설정됨

### 세션 관리
- [ ] 페이지 새로고침 후에도 로그인 상태 유지됨
- [ ] 로그아웃 상태에서 보호된 라우트 접근 시 홈으로 리다이렉트됨
- [ ] 로그아웃 기능 작동 확인
- [ ] 세션이 올바르게 유지됨

## 대시보드

### 메인 대시보드
- [ ] 대시보드가 오류 없이 로드됨
- [ ] 사용자 통계가 올바르게 표시됨:
  - [ ] 남은 크레딧 표시
  - [ ] 총 이미지 수가 정확함
  - [ ] 현재 요금제 표시
- [ ] 최근 이미지 목록에 최신 업로드 항목이 표시됨
- [ ] 이미지가 없을 때 빈 상태(Empty state)가 표시됨
- [ ] 빠른 작업(업로드, 업그레이드)이 작동함

## 이미지 업로드

### 업로드 인터페이스
- [ ] 업로드 페이지가 올바르게 로드됨
- [ ] 드래그 앤 드롭 영역이 보임
- [ ] 클릭하여 파일 선택 기능이 작동함
- [ ] 다중 파일 선택이 지원됨
- [ ] 파일 미리보기가 올바르게 표시됨

### 파일 검증
- [ ] JPEG 파일 허용 확인
- [ ] PNG 파일 허용 확인
- [ ] WebP 파일 허용 확인
- [ ] TIFF 파일 허용 확인
- [ ] 50MB 초과 파일 업로드 시 오류 메시지와 함께 거부됨
- [ ] 지원되지 않는 형식은 거부됨
- [ ] 오류 메시지가 명확하고 도움이 됨

### 업로드 프로세스
- [ ] 단일 파일 업로드 성공 확인
- [ ] 다중 파일 업로드 성공 확인 (2-5개 파일로 테스트)
- [ ] 업로드 진행률 표시기가 작동함
- [ ] 업로드 후 성공 메시지가 나타남
- [ ] 크레딧이 정확하게 차감됨 (무료 사용자)
- [ ] 데이터베이스에 이미지 레코드가 생성됨
- [ ] 파일이 올바른 사용자 폴더에 저장됨
- [ ] 이미지 크기(너비, 높이)가 정확하게 캡처됨

### 크레딧 시스템
- [ ] 무료 사용자: 업로드당 1 크레딧 차감
- [ ] 무료 사용자: 크레딧이 0일 때 업로드 차단됨
- [ ] 크레딧이 부족할 때 경고 표시됨
- [ ] Pro 사용자: 크레딧 차감 없음
- [ ] Pro 사용자: "무제한" 크레딧 표시됨

## AI 메타데이터 생성

### 자동 생성
- [ ] 업로드 후 메타데이터 생성이 자동으로 시작됨
- [ ] 생성 중 처리 상태(Processing status)가 표시됨
- [ ] 생성이 성공적으로 완료됨
- [ ] 메타데이터가 데이터베이스에 저장됨

### 생성된 콘텐츠 품질
- [ ] 제목이 설명적임 (50-70자)
- [ ] 설명이 상세함 (150-200자)
- [ ] 키워드가 관련성이 높음 (25-50개 키워드)
- [ ] 태그가 구체적임 (10-15개 태그)
- [ ] 카테고리가 올바르게 할당됨
- [ ] 신뢰도 점수가 0-1 사이임

### 에러 처리
- [ ] 생성 실패 시 에러 상태가 표시됨
- [ ] 에러 메시지가 캡처됨
- [ ] 사용자가 생성 재시도를 할 수 있음
- [ ] 실패 시에도 원본 이미지는 유지됨

## 이미지 갤러리

### 표시
- [ ] 업로드된 모든 이미지가 표시됨
- [ ] 최신순으로 정렬됨
- [ ] 썸네일이 올바르게 로드됨
- [ ] 상태 배지가 올바른 상태를 보여줌:
  - [ ] "uploading" (회색)
  - [ ] "processing" (파란색)
  - [ ] "completed" (초록색)
  - [ ] "failed" (빨간색)

### 이미지 작업
- [ ] 상세 보기 클릭 시 모달이 열림
- [ ] 상세 보기에서 메타데이터가 표시됨
- [ ] 클립보드 복사 기능 작동 확인:
  - [ ] 제목
  - [ ] 설명
  - [ ] 키워드
  - [ ] 태그
- [ ] 원본 이미지 다운로드 기능 확인
- [ ] 이미지 삭제 기능 확인
- [ ] 삭제 전 확인 대화상자가 표시됨
- [ ] 스토리지에서 이미지가 제거됨
- [ ] 데이터베이스 레코드가 삭제됨 (연쇄 삭제)

### 메타데이터 작업
- [ ] 메타데이터 재생성 기능 확인
- [ ] 새로운 메타데이터가 기존 데이터를 대체함
- [ ] 성공/실패 시 사용자에게 알림이 표시됨

## Pro 기능 (구독)

### 요금제 페이지
- [ ] 요금제 페이지에 두 가지 플랜이 모두 표시됨
- [ ] 기능 비교가 정확함
- [ ] 월간/연간 토글이 작동함
- [ ] 가격이 정확함:
  - [ ] 월간: $19/월
  - [ ] 연간: $190/년
- [ ] 현재 요금제가 강조됨
- [ ] 업그레이드 버튼이 작동함

### Stripe 체크아웃
- [ ] 체크아웃 세션이 성공적으로 생성됨
- [ ] Stripe 체크아웃 페이지로 리다이렉트됨
- [ ] 테스트 카드 승인 확인 (4242 4242 4242 4242)
- [ ] 결제 성공 시 대시보드로 리다이렉트됨
- [ ] 성공 메시지가 표시됨
- [ ] 결제 취소 시 요금제 페이지로 돌아옴

### 구독 웹훅
- [ ] `customer.subscription.created` 처리됨
- [ ] `customer.subscription.updated` 처리됨
- [ ] `customer.subscription.deleted` 처리됨
- [ ] `checkout.session.completed` 처리됨
- [ ] 프로필이 올바르게 업데이트됨:
  - [ ] 플랜이 "pro"로 변경됨
  - [ ] 크레딧이 999999로 설정됨
  - [ ] Stripe 고객 ID 저장됨
  - [ ] 구독 ID 저장됨

### Pro 플랜 혜택
- [ ] 무제한 크레딧 표시 확인
- [ ] 업로드 시 크레딧 차감 없음 확인
- [ ] IPTC 임베딩 사용 가능 확인
- [ ] 배치 처리 사용 가능 확인
- [ ] 우선 순위 배지(Priority badge) 표시 확인

### IPTC 메타데이터 임베딩
- [ ] Pro 사용자만 사용 가능한지 확인
- [ ] 무료 사용자는 업그레이드 안내 문구가 보이는지 확인
- [ ] 이미지 작업에 임베딩 버튼이 나타남
- [ ] 임베딩 프로세스가 완료됨
- [ ] 파일에 메타데이터가 임베딩됨:
  - [ ] IPTC 필드
  - [ ] XMP 필드
  - [ ] EXIF 필드
- [ ] 다운로드가 자동으로 시작됨
- [ ] 파일에 임베딩된 메타데이터가 포함됨 (ExifTool로 확인)

### 빌링 포털
- [ ] 구독 관리 버튼이 작동함
- [ ] Stripe 빌링 포털로 리다이렉트됨
- [ ] 결제 수단을 업데이트할 수 있음
- [ ] 구독을 취소할 수 있음
- [ ] 돌아가기(Return URL) 링크가 작동함

### 구독 취소
- [ ] 취소 웹훅 수신 확인
- [ ] 프로필이 무료 플랜으로 다운그레이드됨
- [ ] 크레딧이 10으로 초기화됨
- [ ] Pro 기능이 비활성화됨
- [ ] 사용자에게 변경 사항이 알림으로 표시됨

## 에러 시나리오

### 네트워크 에러
- [ ] 업로드 실패가 적절히 처리됨
- [ ] 재시도 메커니즘이 작동함
- [ ] 사용자에게 에러 정보가 제공됨
- [ ] 부분적으로 업로드된 파일이 정리됨

### API 에러
- [ ] Gemini API 실패 처리됨
- [ ] Stripe API 에러 처리됨
- [ ] Supabase 에러 처리됨
- [ ] 명확한 에러 메시지가 표시됨

### 검증 에러
- [ ] 잘못된 파일 형식 거부 확인
- [ ] 파일 크기 제한 적용 확인
- [ ] 폼 검증 작동 확인
- [ ] 에러 메시지가 도움이 됨

### 속도 제한(Rate Limiting)
- [ ] Gemini 속도 제한 처리됨
- [ ] 사용자에게 재시도 안내가 표시됨
- [ ] 큐 시스템이 작동함 (구현된 경우)

## 성능

### 로드 시간
- [ ] 대시보드 로딩 < 2초
- [ ] 이미지 갤러리 로딩 < 3초
- [ ] 업로드 인터페이스 반응 속도 확인
- [ ] 메타데이터 생성 < 30초

### 동시 작업
- [ ] 다중 파일 업로드 작동 확인
- [ ] 병렬 메타데이터 생성 확인
- [ ] 레이스 컨디션(Race condition) 없음 확인
- [ ] 데이터베이스 락 처리 확인

### 대용량 파일
- [ ] 50MB 파일 업로드 성공 확인
- [ ] 타임아웃 오류 없음 확인
- [ ] 진행률 표시기가 정확함
- [ ] 메모리 사용량이 허용 범위 내에 있음

## 보안

### 권한 부여
- [ ] 사용자는 본인의 이미지만 볼 수 있음
- [ ] 사용자는 본인의 이미지만 삭제할 수 있음
- [ ] 스토리지 RLS가 무단 접근을 방지함
- [ ] 데이터베이스 RLS가 적용됨

### 데이터 보호
- [ ] API 키가 클라이언트에 노출되지 않음
- [ ] 서명된 URL이 올바르게 만료됨
- [ ] 웹훅 서명이 검증됨
- [ ] Service Role 키가 안전하게 보호됨

### 입력 값 검증
- [ ] 업로드된 파일이 정리(Sanitize)됨
- [ ] XSS 방지가 작동함
- [ ] SQL 인젝션이 방지됨
- [ ] CSRF 보호가 활성화됨

## 모바일 반응형

### 레이아웃
- [ ] 모바일에서 대시보드 반응형 확인
- [ ] 모바일에서 업로드 페이지 사용 가능 확인
- [ ] 이미지 갤러리 그리드가 적절히 조절됨
- [ ] 요금제 페이지 가독성 확인

### 터치 상호작용
- [ ] 터치 환경에서 드래그 앤 드롭 작동 확인
- [ ] 버튼 크기가 적절함
- [ ] 메뉴 접근성이 좋음
- [ ] 모바일에서 모달이 전체 화면으로 표시됨

## 브라우저 호환성

테스트 대상:
- [ ] Chrome (최신 버전)
- [ ] Firefox (최신 버전)
- [ ] Safari (최신 버전)
- [ ] Edge (최신 버전)
- [ ] Mobile Safari (iOS)
- [ ] Chrome Mobile (Android)

## 접근성

### 키보드 네비게이션
- [ ] 모든 대화형 요소에 포커스 가능함
- [ ] 탭 순서가 논리적임
- [ ] Enter/Space 키로 동작이 실행됨
- [ ] Escape 키로 모달이 닫힘

### 스크린 리더
- [ ] 이미지에 대체 텍스트(alt text)가 있음
- [ ] 버튼에 라벨이 있음
- [ ] 폼 입력 항목에 라벨이 있음
- [ ] 상태 메시지가 음성으로 안내됨

### 시각적 요소
- [ ] 색상 대비가 충분함
- [ ] 포커스 표시기가 명확함
- [ ] 에러 상태가 명확함
- [ ] 로딩 상태가 표시됨

## 예외 케이스

### 빈 상태
- [ ] 이미지 없음: 도움이 되는 빈 상태 화면 표시
- [ ] 메타데이터 없음: 적절한 메시지 표시
- [ ] 크레딧 없음: 업그레이드 안내 표시
- [ ] 업로드 실패: 재시도 옵션 제공

### 경계 조건
- [ ] 정확히 0 크레딧일 때의 처리 확인
- [ ] 정확히 10개 파일 업로드 확인
- [ ] 최대 파일 이름 길이 테스트
- [ ] 파일 이름에 특수 문자 포함 테스트

### 동시 사용자
- [ ] 여러 사용자가 동시에 업로드 가능 확인
- [ ] 사용자 간 데이터 유출 없음 확인
- [ ] 크레딧이 정확하게 계산됨
- [ ] 스토리지 할당량이 준수됨

## 데이터베이스 무결성

### 데이터 일관성
- [ ] 외래 키 제약 조건 적용 확인
- [ ] 연쇄 삭제(Cascade delete) 작동 확인
- [ ] 타임아웃 업데이트 확인
- [ ] 크레딧 계산이 정확함

### 마이그레이션
- [ ] 모든 테이블이 생성됨
- [ ] 인덱스가 존재함
- [ ] 함수가 작동함
- [ ] 트리거가 활성화됨

## 모니터링

### 로그
- [ ] 서버 로그 가독성 확인
- [ ] 에러 로그가 이슈를 캡처함
- [ ] 웹훅 로그에 이벤트가 표시됨
- [ ] API 로그가 사용량을 추적함

### 지표
- [ ] 업로드 성공률 확인
- [ ] 메타데이터 생성률 확인
- [ ] 구독 전환율 확인
- [ ] 오류 빈도 확인

## 테스트 후 작업

모든 테스트 완료 후:
- [ ] 발견된 버그 문서화
- [ ] 이슈 우선순위 지정
- [ ] 수정 작업 생성
- [ ] 수정 후 재테스트
- [ ] 문서 업데이트
- [ ] Phase 3 준비

## 테스트 사용자

다음을 위한 테스트 계정을 생성하세요:
- [ ] 무료 사용자 (업그레이드한 적 없음)
- [ ] Pro 월간 구독자
- [ ] Pro 연간 구독자
- [ ] 구독 취소 사용자
- [ ] 크레딧 한도 도달 사용자

## 테스트 데이터

테스트용 이미지를 준비하세요:
- [ ] 작은 JPEG (1MB 이하)
- [ ] 큰 JPEG (10MB 이상)
- [ ] 투명도가 있는 PNG
- [ ] WebP 형식
- [ ] TIFF 형식
- [ ] 다양한 주제 (인물, 풍경, 제품, 추상화)

## Stripe 테스트 카드

다음 테스트 카드를 사용하세요:
- **결제 성공**: `4242 4242 4242 4242`
- **결제 거절**: `4000 0000 0000 0002`
- **3D Secure**: `4000 0025 0000 3155`
- **잔액 부족**: `4000 0000 0000 9995`

모든 테스트 카드 공통:
- 유효기간: 미래의 날짜 아무거나
- CVC: 숫자 3자리 아무거나
- 우편번호(ZIP): 유효한 코드 아무거나

---

## 승인

테스트 완료자: ________________
날짜: ________________
모든 주요 테스트 통과 여부: [ ] 예 [ ] 아니오
Phase 3 진행 준비 완료: [ ] 예 [ ] 아니오

비고:
_______________________________________
_______________________________________
_______________________________________
